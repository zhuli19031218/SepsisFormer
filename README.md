# SepsisFormer and SMART
This repository contains the implementation of the paper
"Explainable AI-driven heterogeneity using coagulationâ€“inflammatory markers improves prognosis prediction, risk stratification, and anticoagulant treatment effects for sepsis".
The code includes all major data, models, algorithms, and experimental settings described in the paper, enabling researchers to reproduce and verify our results. Enjoy~~~

Sepsis, a leading cause of hospital mortality, is characterized by substantial heterogeneity, hindering the development of effective and interpretable prognostic and stratification methods. To address this challenge, we developed an explainable prognostic model (SepsisFormer, a transformer-based deep neural network with an enhanced domain-adaptive generator) and an automated risk stratification tool (SMART, a scorecard consistent with medical knowledge). In a multi-center retrospective study of 12,408 sepsis patients, SepsisFormer achieved high predictive accuracy (AUC: 0.9301, sensitivity: 0.9346, and specificity: 0.8312). SMART (AUC: 0.7360) surpassed most established scoring systems. Based on SMART, four risk levels (mild, moderate, severe, dangerous) can be identified by using seven coagulation-inflammatory routine laboratory measurements and patient age, and the corresponding mortality is approximately 5%, 15%, 30%, and 50%, respectively. Meanwhile, two subphenotypes (CIS1 and CIS2) can be classified through unsupervised GMM, and CIS2 has a worse survival prognosis. Notably, patients with moderate and severe risk levels, especially those with CIS2 subphenotypes, derive more significant benefits from anticoagulant treatment. In conclusion, explainable artificial intelligence (SepsisFormer) drives risk stratification and subphenotypic classification of sepsis, which help to guide anticoagulant treatment. Due to the simple routine biomarkers used, as well as the overt SMART scorecard and open-access web based SMART platform, it will be of great help in improving the clinical practice of sepsis worldwide, especially in middle- and low-income areas.
